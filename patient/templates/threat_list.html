{% extends 'base_layout.html' %}


{% block content %}
<section class="content-header">
      <h1>
        Hasta Modülü

      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="#">Tables</a></li>
        <li class="active">Data tables</li>
      </ol>
</section>

    <!-- delete modal-->
<div class="modal modal-danger fade in deneme22" tabindex="-1" role="dialog" id="modal-danger" aria-hidden="true" style="display: none;">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">×</span></button>
                <h4 class="modal-title">Uyarı</h4>
              </div>
              <div class="modal-body">
                <p>Silmek istediğinizden emin misiniz?</p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-outline pull-left btn-ok" id="btn-conf" data-dismiss="modal">Evet</button>
                <button type="button" class="btn btn-outline" id="btn-close">Hayır</button>
              </div>
            </div>
            <!-- /.modal-content -->
          </div>
          <!-- /.modal-dialog -->
</div>


     <!-- delete modal-->




<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">



   <div class="modal-content" style="height: -webkit-fill-available;">

      <div class="modal-header">
        <h4 class="modal-title" id="myLargeModalLabel">Hasta Detay</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <div class="modal-body bodys">
        ...
      </div>
    </div>
  </div>
</div>


<section class="content">
      <div class="row">
      <div class="col-xs-12">
         <div class="box">
            <div class="box-header">
              <h3 class="box-title">Muayene</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
              <table id="example1" class="table table-bordered table-striped">
                <thead>
                <tr>
                    <th>#</th>
                  <th>Hasta </th>
                  <th>Muayene</th>
                  <th>Muayene Ücreti</th>
                  <th>Muayene Tarihi</th>

                    <th></th>
                </tr>
                </thead>
                <tbody>

                {% for threat in threats %}
                    <tr>
                    <td>{{ forloop.counter }} </td>
                        <td><a class="btn btn-info" onclick="getPatient({{ threat.patient.id }})" style="width:100%"><i class="fa fa-user"> </i>  {{ threat.patient.name }}  {{ threat.patient.surname }}</a></td>
                  <td>{{ threat.threatName }}</td>
                  <td>{{ threat.price }}</td>
                 <td>{{ threat.creationDate }}</td>
                  <td> <div class="btn-group">

                      <a href ="{% url "patient:muayene-guncelle" threat.pk %}" class="btn btn-warning" ><i class="fa fa-edit"></i>Güncelle</a>
                    </div>  </td>
                </tr>

                {% endfor %}

                </tbody>
                <tfoot>
                <tr>
                    <th></th>
                    <th>Hasta</th>
                    <th>Muayene</th>
                    <th>Muayene Ücreti</th>
                    <th>Muayene Tarihi</th>

                    <th></th>
                </tr>
                </tfoot>
              </table>
            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->
        </div>
        <!-- /.col -->

      </div>
      </div>









</section>



<script>
    function deactivePatient(id){

      // $('#modal-danger').modal('show');


      $("#modal-danger").on("shown.bs.modal", function(e)
        {
           $("#btn-conf").click(function(){

               $.ajax({
            url : "{% url "patient:hasta-sil" pk=212121223232323232 %}".replace(/212121223232323232/, id.toString()),
            type : "POST",
            data : {
                'csrfmiddlewaretoken' : "{{  csrf_token  }}",
                isActive : 'False'
                 },
            success : function(result) {

                window.location.replace("{% url "patient:index" %}");
                console.log(result.status)
                }
        });

            });
        }).modal('show');


      $('#btn-close').click(function() {
    $('#modal-danger').modal('hide');
});



        /*$.ajax({
            url : "{#% url "patient:hasta-sil" pk=2121212 %#}".replace(/2121212/, id.toString()),
            type : "POST",
            data : {
                'csrfmiddlewaretoken' : "{#  #}{  csrf_token  }}",
                isActive : 'True'
                 },
            success : function(result) {
                console.log(result[0].status)
                }
        });*/
    }


    function getPatient(id) {
        var html ='';
        $.get(" {% url "patient:getPatient" pk=12121   %}".replace(/12121/, id.toString()))
     .done(function(response) {

         debugger;
          html += '<div class="form-row">';
          html += '<div class="col-md-6">';
          html += '<label for="validationDefault01">Ad Soyad:</label>';
          html +=  '<p for="validationDefault01">'+response.user[0].name+'  '+response.user[0].surname+'</p>';
          html += '</div>';

          html += '<div class="col-md-6">';
          html += '<label for="validationDefault01">Hasta Kayıt Numarası</label>';
          html +=  '<p for="validationDefault01">'+response.user[0].patientNumber+'</p>';
          html += '</div>';
          html += '</div><br>'

          html += '<div class="form-row">';
          html += '<div class="col-md-6">';
          html += '<label for="validationDefault01">Telefon Numarası</label>';
          html +=  '<p for="validationDefault01">'+response.user[0].mobilePhone+'</p>';
          html += '</div>';

          html += '<div class="col-md-6">';
          html += '<label for="validationDefault01">Hasta Durumu</label>';
          html +=  '<p for="validationDefault01">'+response.user[0].isActive+'</p>';
          html += '</div>';
          html += '</div><br>'

          html += '<div class="form-row">';
          html += '<div class="col-md-6">';
          html += '<label for="validationDefault01">Doğum Tarihi</label>';
          html +=  '<p for="validationDefault01">'+response.user[0].birthDate+'</p>';
          html += '</div>';

          html += '<div class="col-md-6">';
          html += '<label for="validationDefault01">Kayıt Tarihi</label>';
          html +=  '<p for="validationDefault01">'+response.user[0].creationDate+'</p>';
          html += '</div>';
          html += '</div><br>'

          html += '<div class="form-row">';
          html += '<div class="col-md-6">';
          html += '<label for="validationDefault01">Adres: </label>';
          html +=  '<p for="validationDefault01">'+response.user[0].address+'</p>';
          html += '</div>';


          html += '</div><br>'


         $(".bodys").html(html);

        });

           $('.bd-example-modal-lg').modal('show');


           $(".bd-example-modal-lg").on("hidden.bs.modal", function () {
    // put your default event here
                $(".bodys").html("");
          });


    }
</script>
{% endblock %}

