{% extends 'base_layout.html' %}




{% block content %}
    {% load staticfiles %}
    <script
            src="https://code.jquery.com/jquery-3.4.0.js"
            integrity="sha256-DYZMCC8HTC+QDr5QNaIcfR7VSPtcISykd+6eSmBW5qo="
            crossorigin="anonymous"></script>

    <script src="{% static 'fieldChooser/js/jquery.lwMultiSelect.js' %}"></script>
    <section>
        {% if messages %}
            <div class="alert alert-danger alert-dismissible">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                <h4><i class="icon fa fa-ban"></i> Hata!</h4>


                <ul class="messages">
                    {% for message in messages %}
                        <li class="{{ message.tags }}">{{ message }}</li>
                    {% endfor %}
                </ul>


            </div>
        {% endif %}
        <form action="" method="post" enctype="multipart/form-data" class="content">
            <div class="box box-default">
                <div class="box-header with-border">
                    <h3 class="box-title">{{ class.name }} Sınıf Oluştur</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i
                                class="fa fa-minus"></i></button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-remove"></i>
                        </button>
                    </div>
                </div>
                <!-- /.box-header -->


                {% csrf_token %}

                <div class="box-body">
                    <!-- -->
                    <div class="jquery-script-clear"></div>
                    <div class="container">


                        <p><select id="defaults" multiple="multiple">

                            {% for student in students %}
                                <
                                <option value="{{ student.id }}"
                                        data-img-src="{% if request.is_secure %}HTTPS{% else %}HTTP{% endif %}://{{ request.get_host }}/media/{{ student.profileImage }}">{{ student.user.first_name }} {{ student.user.last_name }}</option>
                            {% endfor %}

                        </select>
                    </div>
                    </p>
                    <script>
                        jQuery('#defaults').lwMultiSelect(
                            {
                                onChange: function () {
                                    console.log($('#defaults').val())
                                }
                            }
                        );


                        debugger;
                        $('#defaults').data('plugin_lwMultiSelect').selectItem({{ student.id }});

                    </script>




                    <!-- -->


                    <!-- /.box-body -->
                    <div class="box-footer">
                        <button id="send"  class="btn btn-primary pull-right">Kaydet</button>
                    </div>


                </div>
            <script>
                        // yanit idli linke tıklanırsa çalış
                        $('#send').on('click', function (event) {

                             console.log("asasa");
                            $.ajax({
                                url: "{% url 'education:ajax' %}",
                                type: 'POST',
                                dataType: 'json',
                                data: {
                                    csrfmiddlewaretoken: "{{ csrf_token }}",
                                    values : $('#defaults').val(),
                                    class : {{ class.pk }}
                                }
                            }).done(function (response) {
                                // okunan json veriyi, #user idli yere yaz
                                console.log(response)
                            });
                            event.preventDefault();
                        });
                    </script>

            </div>
        </form>
    </section>


{% endblock %}